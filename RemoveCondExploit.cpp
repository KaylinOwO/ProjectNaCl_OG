#include "RemoveCondExploit.h"

RemoveCondExploits gCond;

void RemoveCondExploits::Run(CBaseEntity* pLocal, CUserCmd* pCommand)
{
	if (!gCvars.removecond_enabled)
		return;

	if (Util->IsKeyPressed(gCvars.removecond_key) //G
												  //  && pLocal->GetLifeState() == LIFE_ALIVE
		&& !gInts.Engine->Con_IsVisible()
		&& gInts.Engine->IsConnected())
		RemoveConds(pLocal, pCommand, (int)gCvars.removecond_value);
}
void RemoveCondExploits::RemoveConds(CBaseEntity * local, CUserCmd * cmd, int value, bool disableattack)
{
	if (local == NULL) return;

	if (local->GetLifeState() != LIFE_ALIVE) return;

	INetChannel* ch = (INetChannel*)gInts.Engine->GetNetChannelInfo();
	int& m_nOutSequenceNr = *(int*)((unsigned)ch + 8);
	m_nOutSequenceNr += value;
}

void RemoveCondExploits::RemoveConds(CBaseEntity *local, int value)
{
	RemoveConds(local, new CUserCmd(), value);
}
